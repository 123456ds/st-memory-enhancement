<!-- customSheetStyle.html -->
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>HTML Renderer</title>
    <style>
        body { font-family: sans-serif; }
        textarea { width: 100%; height: 200px; box-sizing: border-box; margin-bottom: 10px; }
        #tableRendererDisplay { border: 1px solid #ccc; padding: 10px; margin-top: 10px; min-height: 100px; }
    </style>
</head>
<body>
<h2 class="marginBot5"><span data-i18n="customTableStyleTitle">自定义表格样式</span></h2>
<small data-i18n="customTableStyleDesc">
    自定义表格的显示样式，当样式内容为空时默认显示原始表格。
    <br>支持HTML、CSS定义结构样式，并使用<code>\$\w\s+</code>的方式定位单元格。
    <br>例如<code>$A0</code>代表第1列第1行(表头)，<code>$A1</code>代表第1列第2行(表内容第一行)。
</small>
<hr>
<div class="flex-container" style="display: flex; flex-direction: column; gap: 10px; margin: 10px 0; ">
    <div style=" display: flex; flex-direction: row; gap: 10px;">
        <input checked type="checkbox" id="table_style_button">
        <label data-i18n="enableCustomStyleLabel">启用该表的自定义样式</label>
    </div>
    <div style=" display: flex; flex-direction: row; gap: 10px;">
        <input checked type="checkbox" id="table_to_chat_button">
        <label data-i18n="pushToChatLabel">推送至对话</label>
        <small data-i18n="pushToChatDesc">(开启时将该表格以下预览中的样式推送至对话)</small>
    </div>
    <!--    <div style=" display: flex; flex-direction: column; text-align: left">-->
    <!--        <label>使用正则替换对话中的内容：</label>-->
    <!--        <input type="text" class="text_pole" id="table_to_chat_replace">-->
    <!--    </div>-->
    <div style=" display: flex; flex-direction: column; text-align: left">
        <label data-i18n="replacementStyleLabel">替换样式：</label>
        <textarea id="htmlEditor" rows="5"></textarea>
    </div>
</div>
<hr>
<h3 class="marginBot5"><span data-i18n="stylePreviewLabel">样式预览:</span></h3>
<div id="tableRendererDisplay"></div>

<script>
    const htmlEditor = document.getElementById('htmlEditor');
    const tableRendererDisplay = document.getElementById('tableRendererDisplay');
    const renderHTML = () => {
        const htmlCode = htmlEditor.value;
        tableRendererDisplay.innerHTML = htmlCode; // 使用 innerHTML 来渲染 HTML
    };
    htmlEditor.addEventListener('input', renderHTML);
</script>
</body>
</html>
